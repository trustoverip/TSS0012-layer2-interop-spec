


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Technology Stack Layer 2 Interoperability Specification">
      
      
      
        <meta name="author" content="Trust over IP Foundation">
      
      
        <link rel="canonical" href="https://trustoverip.github.io/mkdocs-material/">
      
      <link rel="shortcut icon" href="theme/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.5">
    
    
      
        <title>TSWG Layer 2 Interop Spec</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.15aa0b43.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.75751829.min.css">
        
          
          
          <meta name="theme-color" content="#ffffff">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="theme/stylesheets/main.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="white" data-md-color-accent="indigo">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#title-ex-0000-deliverable-name" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-announce">
          <div class="md-announce__inner md-grid md-typeset">
            
  <a href="https://www.linuxfoundation.org/projects" target="_blank" rel="noopener noreferrer">
    <img src="theme/images/banner.png" />
  </a>

          </div>
        </aside>
      
    </div>
    
      




<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://trustoverip.org/" title="TSWG Layer 2 Interop Spec" class="md-header-nav__button md-logo" aria-label="TSWG Layer 2 Interop Spec">
      
  <img src="theme/images/logo.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            TSS012: Layer2 Interop Spec
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Title (Ex. 0000: Deliverable Name)
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/trustoverip/TSS0012-layer2-interop-spec/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    trustoverip/TSS0012-layer2-interop-spec
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://trustoverip.github.io/mkdocs-material/" title="TSWG Layer 2 Interop Spec" class="md-nav__button md-logo" aria-label="TSWG Layer 2 Interop Spec">
      
  <img src="theme/images/logo.svg" alt="logo">

    </a>
    Table of contents
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/trustoverip/TSS0012-layer2-interop-spec/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    trustoverip/TSS0012-layer2-interop-spec
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="foreword/" class="md-nav__link">
        Foreword
      </a>
    </li>
  

    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="scope/" class="md-nav__link">
        Scope
      </a>
    </li>
  

    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="references/" class="md-nav__link">
        References
      </a>
    </li>
  

    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="definitions/" class="md-nav__link">
        Definitions
      </a>
    </li>
  

    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="description/" class="md-nav__link">
        Layer 2-3 description
      </a>
    </li>
  

    
      
      
      


  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" >
      
      <label class="md-nav__link" for="nav-6">
        Layer 2-3 specification
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Layer 2-3 specification" data-md-level="1">
        <label class="md-nav__title" for="nav-6">
          <span class="md-nav__icon md-icon"></span>
          Layer 2-3 specification
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="specification/specification/" class="md-nav__link">
        Specification
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      


  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" >
      
      <label class="md-nav__link" for="nav-7">
        Annexes
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Annexes" data-md-level="1">
        <label class="md-nav__title" for="nav-7">
          <span class="md-nav__icon md-icon"></span>
          Annexes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="annex/annex_a/" class="md-nav__link">
        Annex A Normative transactions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="annex/annex_b/" class="md-nav__link">
        Annex B Implementation considerations
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="annex/annex_c/" class="md-nav__link">
        Annex C Specified protocols
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="annex/annex_d/" class="md-nav__link">
        Annex D Reference model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="annex/annex_e/" class="md-nav__link">
        Annex E Cryptogrpahy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#motivation" class="md-nav__link">
    Motivation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tutorial" class="md-nav__link">
    Tutorial
  </a>
  
    <nav class="md-nav" aria-label="Tutorial">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#name-and-version" class="md-nav__link">
    Name and Version
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-concepts" class="md-nav__link">
    Key Concepts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#roles" class="md-nav__link">
    Roles
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#states" class="md-nav__link">
    States
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#messages" class="md-nav__link">
    Messages
  </a>
  
    <nav class="md-nav" aria-label="Messages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adopted-messages" class="md-nav__link">
    Adopted Messages
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constraints" class="md-nav__link">
    Constraints
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    Reference
  </a>
  
    <nav class="md-nav" aria-label="Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#messages-details" class="md-nav__link">
    Messages Details
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collateral" class="md-nav__link">
    Collateral
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#localization" class="md-nav__link">
    Localization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codes-catalog" class="md-nav__link">
    Codes Catalog
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#drawbacks" class="md-nav__link">
    Drawbacks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rationale-and-alternatives" class="md-nav__link">
    Rationale and alternatives
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prior-art" class="md-nav__link">
    Prior art
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unresolved-questions" class="md-nav__link">
    Unresolved questions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementations" class="md-nav__link">
    Implementations
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/trustoverip/TSS0012-layer2-interop-spec/edit/master/docs/index.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="title-ex-0000-deliverable-name">Title (Ex. 0000: Deliverable Name)<a class="headerlink" href="#title-ex-0000-deliverable-name" title="Permanent link">&para;</a></h1>
<ul>
<li>Authors: <a href="you@github-email">your name</a> -- email is optional</li>
<li>Deliverable Type: <em>Spec - Protocol</em> </li>
<li>Status: <a href="./process/lifecycle_management.md">PROPOSED</a></li>
<li>Since: YYYY-MM-DD (date you submit your PR)</li>
<li>Status Note: (explanation of current status)  </li>
<li>Supersedes: (link to anything this ToIP Deliverable  supersedes)</li>
<li>Start Date: YYYY-MM-DD (date you started working on this idea)</li>
<li>Tags: (see ../../../tags.md)</li>
</ul>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>One paragraph explanation of the feature.</p>
<blockquote>
<p>If the RFC you are proposing is <strong>NOT</strong> a protocol, please use <a href="https://github.com/hyperledger/aries-rfcs/tree/master/0000-template.md">this template</a> as a starting point.</p>
<p>When completing this template and before submitting as a PR, please remove the template text in sections (other than <strong>Implementations</strong>). The implementations section should remain as is.</p>
</blockquote>
<h2 id="motivation">Motivation<a class="headerlink" href="#motivation" title="Permanent link">&para;</a></h2>
<p>Why are we doing this? What use cases does it support? What is the expected outcome?</p>
<h2 id="tutorial">Tutorial<a class="headerlink" href="#tutorial" title="Permanent link">&para;</a></h2>
<h3 id="name-and-version">Name and Version<a class="headerlink" href="#name-and-version" title="Permanent link">&para;</a></h3>
<p>Name and Version</p>
<p>Specify the official name of the protocol and its version, e.g., "My Protocol 0.9".</p>
<p>Protocol names are often either lower_snake_case or kebob-case. The non-version components of the protocol named are matched exactly.</p>
<p>URI: <a href="https://didcomm.org/lets_do_lunch/">https://didcomm.org/lets_do_lunch/</a><version>/<messageType></p>
<p>Message types and protocols are identified with special URIs that match certain conventions. See <a href="https://github.com/hyperledger/aries-rfcs/tree/master/concepts/0003-protocols/uris.md">Message Type and Protocol Identifier URIs</a> for more details.</p>
<p>The version of a protocol is declared carefully. See <a href="https://github.com/hyperledger/aries-rfcs/tree/master/concepts/0003-protocols/semver.md">Semver Rules for Protocols</a> for details.</p>
<h3 id="key-concepts">Key Concepts<a class="headerlink" href="#key-concepts" title="Permanent link">&para;</a></h3>
<p>This is short--a paragraph or two. It defines terms and describes the flow of
the interaction at a very high level. Key preconditions should be noted (e.g.,
"You can't issue a credential until you have completed the <em>connection</em> protocol
first"), as well as ways the protocol can start and end, and what can go wrong.
The section might also talk about timing constraints and other assumptions.
After reading this section, a developer should know what problem your protocol
solves, and should have a rough idea of how the protocol works in its simpler
variants.</p>
<h3 id="roles">Roles<a class="headerlink" href="#roles" title="Permanent link">&para;</a></h3>
<blockquote>
<p>See <a href="https://github.com/hyperledger/aries-rfcs/tree/master/concepts/0003-protocols/roles-participants-etc.md">this note</a> for definitions of the terms
"role", "participant", and "party".</p>
</blockquote>
<p>Provides a formal name to each role in the protocol, says who and how many can
play each role, and describes constraints associated with those roles (e.g.,
"You can only issue a credential if you have a DID on the public ledger"). The
issue of qualification for roles can also be explored (e.g., "The holder of the
credential must be known to the issuer").</p>
<p>The formal names for each role are important because they are used when <a href="https://github.com/hyperledger/aries-rfcs/tree/master/features/0031-discover-features">agents
discover one another's
capabilities</a>;
an agent doesn't just claim that it supports a protocol; it makes a claim about
which <em>roles</em> in the protocol it supports. An agent that supports credential
issuance and an agent that supports credential holding may have very different
features, but they both use the <em>credential-issuance</em> protocol. By convention,
role names use lower-kebab-case and are compared case-sensitively.</p>
<h3 id="states">States<a class="headerlink" href="#states" title="Permanent link">&para;</a></h3>
<p>This section lists the possible states that exist for each role. It also
enumerates the events (often but not always messages) that can occur, including
errors, and what should happen to state as a result. A formal representation of
this information is provided in a <em>state machine matrix</em>. It lists events as
columns, and states as rows; a cell answers the question, "If I am in state X
(=row), and event Y (=column) occurs, what happens to my state?" The <a href="https://github.com/hyperledger/aries-rfcs/blob/master/concepts/0003-protocols/tictactoe/README.md#states">Tic Tac
Toe example</a> is typical.</p>
<p><a href="https://www.visual-paradigm.com/guide/bpmn/bpmn-orchestration-vs-choreography-vs-collaboration/#bpmn-choreography">Choreography Diagrams</a>
from <a href="http://www.bpmn.org/">BPMN</a> are good artifacts here, as are <a href="http://plantuml.com/sequence-diagram">PUML sequence diagrams</a> and <a href="http://agilemodeling.com/artifacts/stateMachineDiagram.htm">UML-style state machine diagrams</a>.
The matrix form is nice because it forces an exhaustive analysis of every
possible event. The diagram styles are often simpler to create and consume,
and the PUML and BPMN forms have the virtue that they can support line-by-line
diffs when checked in with source code. However, they don't offer an
easy way to see if all possible flows have been considered; what they may
NOT describe isn't obvious. This--and the freedom from fancy tools--is why
the matrix form is used in many early RFCs. We leave it up to
the community to settle on whether it wants to strongly recommend specific
diagram types.</p>
<p>The formal names for each state are important, as they are used in <a href="https://github.com/hyperledger/aries-rfcs/tree/master/features/0015-acks"><code>ack</code>s</a>
and <a href="https://github.com/hyperledger/aries-rfcs/tree/master/features/0035-report-problem"><code>problem-report</code>s</a>).
For example, a <code>problem-report</code> message declares which state the sender
arrived at because of the problem. This helps other participants
to react to errors with confidence. Formal state names are also used in the
agent test suite, in log messages, and so forth.</p>
<p>By convention, state names use lower-kebab-case. They are compared
case-sensitively.</p>
<p>State management in protocols is a deep topic. For more information, please
see <a href="https://github.com/hyperledger/aries-rfcs/blob/master/concepts/0003-protocols/state-details.md">State Details and State Machines</a>.</p>
<h3 id="messages">Messages<a class="headerlink" href="#messages" title="Permanent link">&para;</a></h3>
<p>This section describes each message in the protocol. It should also note the names and
versions of messages from other message families that are adopted by the
protocol (e.g., an <a href="https://github.com/hyperledger/aries-rfcs/tree/master/features/0015-acks"><code>ack</code></a>
or a <a href="https://github.com/hyperledger/aries-rfcs/tree/master/features/0035-report-problem"><code>problem-report</code></a>).
Typically this section is written as a narrative, showing each message
type in the context of an end-to-end sample interaction. All possible
fields may not appear; an exhaustive catalog is saved for the "Reference"
section.</p>
<p>Sample messages that are presented in the narrative should also be checked
in next to the markdown of the RFC, in <a href="https://github.com/hyperledger/aries-rfcs/tree/master/features/0044-didcomm-file-and-mime-types#didcomm-messages-dm">DIDComm Plaintext format</a>.</p>
<p>The <em>message</em> element of a message type URI are typically lower_camel_case or lower-kebab-case, matching
the style of the protocol. JSON items in messages are lower_camel_case and inconsistency in the
application of a style within a message is frowned upon by the community.</p>
<h4 id="adopted-messages">Adopted Messages<a class="headerlink" href="#adopted-messages" title="Permanent link">&para;</a></h4>
<p>Many protocols should use general-purpose messages such as <a href="https://github.com/hyperledger/indy-hipe/pull/77"><code>ack</code></a> and <a href="https://github.com/hyperledger/indy-hipe/pull/65"><code>problem-report</code></a>) at certain points in
an interaction. This reuse is strongly encouraged because it helps us avoid
defining redundant message types--and the code to handle them--over and
over again (see <a href="https://en.wikipedia.org/wiki/Don't_repeat_yourself">DRY principle</a>).</p>
<p>However, using messages with generic values of <code>@type</code> (e.g., <code>"@type":
"https://didcomm.org/notification/1.0/ack"</code>)
introduces a challenge for agents as they route messages to their internal
routines for handling. We expect internal handlers to be organized around
protocols, since a protocol is a discrete unit of business value as well
as a unit of testing in our agent test suite. Early work on agents has
gravitated towards pluggable, routable protocols as a unit of code
encapsulation and dependency as well. Thus the natural routing question
inside an agent, when it sees a message, is "Which protocol handler should
I route this message to, based on its <a class="magiclink magiclink-github magiclink-mention" href="https://github.com/type" title="GitHub User: type">@type</a>?" A generic <code>ack</code> can't be
routed this way.</p>
<p>Therefore, we allow a protocol to <strong>adopt</strong> messages into its namespace.
This works very much like python's <code>from module import symbol</code> syntax.
It changes the <code>@type</code> attribute of the adopted message. Suppose a <code>rendezvous</code>
protocol is identified by the URI <code>https://didcomm.org/rendezvous/2.0</code>,
and its definition announces that it has adopted generic 1.x <code>ack</code>
messages. When such <code>ack</code> messages are sent, the <code>@type</code> should now use
the alias defined inside the namespace of the <code>rendezvous</code> protocol:</p>
<p><img alt="diff on @type caused by adoption" src="concepts/0003-protocols/adoption.png" /></p>
<p>Adoption should be declared in an "Adopted" subsection of "Messages".
When adoption is specified, it should include a <strong>minimum
adopted version</strong> of the adopted message type: "This protocol adopts
<code>ack</code> with version &gt;= 1.4". All versions of the adopted message that share
the same major number should be compatible, given the <a href="concepts/0003-protocols/semver.md">semver rules</a>
that apply to protocols.</p>
<h3 id="constraints">Constraints<a class="headerlink" href="#constraints" title="Permanent link">&para;</a></h3>
<p>Many protocols have constraints that help parties build trust.
For example, in buying a house, the protocol includes such things as
commission paid to realtors to guarantee their incentives, title insurance,
earnest money, and a phase of the process where a home inspection takes
place. If you are documenting a protocol that has attributes like
these, explain them here. If not, the section can be omitted.</p>
<h2 id="reference">Reference<a class="headerlink" href="#reference" title="Permanent link">&para;</a></h2>
<p>All of the sections of reference are optional. If none are needed, the
"Reference" section can be deleted.</p>
<h3 id="messages-details">Messages Details<a class="headerlink" href="#messages-details" title="Permanent link">&para;</a></h3>
<p>Unless the "Messages" section under "Tutorial" covered everything that
needs to be known about all message fields, this is where the data type,
validation rules, and semantics of each field in each message type are
details. Enumerating possible values, or providing ABNF or regexes is
encouraged. Following conventions such as <a href="https://github.com/hyperledger/aries-rfcs/tree/master/concepts/0074-didcomm-best-practices#date-time-conventions">those for date-
and time-related fields</a>
can save a lot of time here.</p>
<p>Each message type should be associated with one or more roles in the
protocol. That is, it should be clear which roles can send and receive
which message types.</p>
<p>If the "Tutorial" section covers everything about the messages, this
section should be deleted.</p>
<h3 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h3>
<p>This section is optional. It can be used to show alternate flows through
the protocol.</p>
<h3 id="collateral">Collateral<a class="headerlink" href="#collateral" title="Permanent link">&para;</a></h3>
<p>This section is optional. It could be used to reference files, code,
relevant standards, oracles, test suites, or other artifacts that would
be useful to an implementer. In general, collateral should be checked in
with the RFC.</p>
<h3 id="localization">Localization<a class="headerlink" href="#localization" title="Permanent link">&para;</a></h3>
<p>If communication in the protocol involves humans, then localization of
message content may be relevant. Default settings for localization of
all messages in the protocol can be specified in an <code>l10n.json</code> file
described here and checked in with the RFC. See <a href="https://github.com/hyperledger/aries-rfcs/tree/master/concepts/0011-decorators#decorator-scope">"Decorators at Message
Type Scope"</a>
in the <a href="https://github.com/hyperledger/aries-rfcs/tree/master/features/0043-l10n">Localization RFC</a>.</p>
<h3 id="codes-catalog">Codes Catalog<a class="headerlink" href="#codes-catalog" title="Permanent link">&para;</a></h3>
<p>If the protocol has a formally defined catalog of codes (e.g., for errors
or for statuses), define them in this section. See <a href="https://github.com/hyperledger/aries-rfcs/blob/master/features/0043-l10n/README.md#message-codes-and-catalogs">"Message Codes and
Catalogs"</a>
in the <a href="https://github.com/hyperledger/aries-rfcs/blob/master/features/0043-l10n">Localization RFC</a>.</p>
<h2 id="drawbacks">Drawbacks<a class="headerlink" href="#drawbacks" title="Permanent link">&para;</a></h2>
<p>Why should we <em>not</em> do this?</p>
<h2 id="rationale-and-alternatives">Rationale and alternatives<a class="headerlink" href="#rationale-and-alternatives" title="Permanent link">&para;</a></h2>
<ul>
<li>Why is this design the best in the space of possible designs?</li>
<li>What other designs have been considered and what is the rationale for not
choosing them?</li>
<li>What is the impact of not doing this?</li>
</ul>
<h2 id="prior-art">Prior art<a class="headerlink" href="#prior-art" title="Permanent link">&para;</a></h2>
<p>Discuss prior art, both the good and the bad, in relation to this proposal.
A few examples of what this can include are:</p>
<ul>
<li>Does this feature exist in other SSI ecosystems and what experience have
their community had?</li>
<li>For other teams: What lessons can we learn from other attempts?</li>
<li>Papers: Are there any published papers or great posts that discuss this?
If you have some relevant papers to refer to, this can serve as a more detailed
theoretical background.</li>
</ul>
<p>This section is intended to encourage you as an author to think about the
lessons from other implementers, provide readers of your proposal with a
fuller picture. If there is no prior art, that is fine - your ideas are
interesting to us whether they are brand new or if they are an adaptation
from other communities.</p>
<p>Note that while precedent set by other communities is some motivation, it
does not on its own motivate an enhancement proposal here. Please also take
into consideration that Aries sometimes intentionally diverges from common
identity features.</p>
<h2 id="unresolved-questions">Unresolved questions<a class="headerlink" href="#unresolved-questions" title="Permanent link">&para;</a></h2>
<ul>
<li>What parts of the design do you expect to resolve through the
enhancement proposal process before this gets merged?</li>
<li>What parts of the design do you expect to resolve through the
implementation of this feature before stabilization?</li>
<li>What related issues do you consider out of scope for this
proposal that could be addressed in the future independently of the
solution that comes out of this doc?</li>
</ul>
<h2 id="implementations">Implementations<a class="headerlink" href="#implementations" title="Permanent link">&para;</a></h2>
<blockquote>
<p>NOTE: This section should remain in the RFC as is on first release. Remove this note and leave the rest of the text as is. Template text in all other sections should be removed before submitting your Pull Request.</p>
</blockquote>
<p>The following lists the implementations (if any) of this RFC. Please do a pull request to add your implementation. If the implementation is open source, include a link to the repo or to the implementation within the repo. Please be consistent in the "Name" field so that a mechanical processing of the RFCs can generate a list of all RFCs supported by an Aries implementation.</p>
<p><em>Implementation Notes</em> <a href="README.md#accepted">may need to include a link to test results</a>.</p>
<table>
<thead>
<tr>
<th>Name / Link</th>
<th>Implementation Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 Joint Development Foundation Projects, LLC, Trust over IP Foundation Series <a href="https://jdfprojects.org/toip/">Terms of Use, Privacy Policy and Cookie Policy</a>. The Joint Development Foundation Projects, LLC is an affiliate of the Linux Foundation.
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/trustoverip" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/trustoverip" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.linkedin.com/company/trust-over-ip-foundation" target="_blank" rel="noopener" title="www.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/vendor.93c04032.min.js"></script>
      <script src="assets/javascripts/bundle.83e5331e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: ".",
          features: ['navigation.instant'],
          search: Object.assign({
            worker: "assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://unpkg.com/mermaid@8.6.4/dist/mermaid.min.js"></script>
      
        <script src="theme/javascripts/main.js"></script>
      
    
  </body>
</html>